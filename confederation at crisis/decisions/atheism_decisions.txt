decisions = {
	# Switch to PDD
#	atheism_decision_PDD = {
#		#only_playable = yes
#		#ai = no
#		potential = {
#			is_ruler = yes
#			#NOT = { controls_religion = yes }
#			OR = {
#				religion = atheism 
#				religion = atheism_reformed
#			}
#			OR = {
#				government = feudal_government
#				government = muslim_government
#				government = theocratic_feudal_government
#				government = merchant_republic_government
#				government = chinese_imperial_government
#				government = order_government
#				government = roman_imperial_government
#			}
#		}
#		allow = {
#			atheism_canusepdd_trigger = yes
#			custom_tooltip = {
#				text = atheism_tooltip_notemples
#				hidden_tooltip = {
#					NOT = {
#						any_demesne_title = {
#							holding_type = temple
#						}
#					}
#				}
#			}
#		}
#		effect = {
#			set_government_type = PDD_government
#		}
#		revoke_allowed = {
#			always = no #Not used in vanilla
#		}
#		ai_will_do = {
#			factor = 1
#		}
#	}
#
#	# Switch from PDD to Feudal
#	atheism_decision_regularfeudal = {
#		only_playable = yes
#		ai = no
#		potential = {
#			is_ruler = yes
#			NOT = { controls_religion = yes }
#			OR = {
#				religion = atheism 
#				religion = atheism_reformed
#				religion = atheism_revised
#			}
#			government = PDD_government
#		}
#		allow = {
#			is_government_potential = feudal_government
#		}
#		effect = {
#			set_government_type = feudal_government
#		}
#		revoke_allowed = {
#			always = no #Not used in vanilla
#		}
#		ai_will_do = {
#			factor = 0
#		}
#	}
	

	# Ensures that atheist characters have correct traits.
	# Removes cynical, adds atheist_rat, converts zealous to atheist_zeal.
	atheism_decision_fixself = {
		only_playable = yes
		potential = {
			OR = {
				religion = atheism 
				religion = atheism_reformed
			}
			OR = {
				trait = cynical
				trait = zealous
				NOT = { trait = atheist_rat }
			}
		}
		allow = {
		}
		effect = {
			atheism_fixtraits = yes
		}
		revoke_allowed = {
			always = no #Not used in vanilla
		}
		ai_will_do = {
			factor = 1
		}
	}


	# Form the Union of Socialist Republics
	form_the_usr = {
		only_independent = yes
		is_high_prio = yes
		ai_check_interval = 24
		
		potential = {
			is_playable = yes
			independent = yes
			OR = {
				religion = atheism
				religion = atheism_reformed
			}
			e_usr = {
				has_holder = no
			}
			is_alternate_start = no
			NOT = {
				has_game_rule = {
					name = dynamic_realms
					value = off
				}
			}
		}
		allow = {
			is_adult = yes
			prisoner = no
			NOT = { trait = incapable }
			prestige = 2000
			OR = {
				realm_size = 1500
				custom_tooltip = {
					text = form_usr_requirement_tooltip
					hidden_tooltip = {
						any_demesne_title = {
							count = 15
							tier = KING
						}
					}
				}
			}
			#has_landed_title = k_germany
			conditional_tooltip = {
				trigger = {
					ai = no
				}

				scaled_wealth = 2
			}
		}
		effect = {
			if = {
				limit = {
					ai = no
				}
				scaled_wealth = -2
			}
			if = {
				limit = { has_nickname = no }
				give_nickname = nick_revolution_leader
			}
			primary_title = {
				e_usr = {
					grant_title = ROOT
					copy_title_laws = PREV
					add_law = succ_hre_elective
				}
			}

			#hidden_tooltip = {
			#	princely_elective_german_elector_setup_effect = yes
			#}
			any_demesne_title = {
				limit = {
					OR = {
						tier = KING
						AND = {
							tier = EMPEROR
							NOT = {
								title = e_usr
							}
						}
					}
				}
				destroy_landed_title = THIS
			}
			hidden_tooltip = {
				any_landed_title = {
					limit = {
						tier = KING
					}
					de_jure_liege = e_usr
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
		}
	}




	# Convert to Revised Atheism
	convert_to_revised_atheism = {
		#only_playable = yes
		#ai = no
		ai_check_interval = 12 #check only once every 12 months.
		potential = {
			NOT = { controls_religion = yes }
			religion = atheism_reformed
			OR = {
				has_secret_religion = no
				NOT = {secret_religion = atheism_revised}
			}
		}
		allow = {
			NOT = { controls_religion = yes }
			religion = atheism_reformed
		}
		effect = {
			set_secret_religion = atheism_revised
		}
		revoke_allowed = {
			always = no #Not used in vanilla
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.004
			}
		}
	}

}


settlement_decisions = {
	#Atheist Impressed By Local Religion
	atheist_impressed_by_local_religion = {
		ai_check_interval = 24 #check only once every 24 months.
		filter = owned
		ai_target_filter = owned
		
		from_potential = {
			is_playable = yes
			has_dlc = "Holy Fury"
			higher_tier_than = BARON
			religion = atheism_reformed
			OR = {
				has_secret_religion = no
				NOT = {secret_religion = atheism_revised}
			}
		}
		
		potential = {
			holder_scope = {
				character = FROM
			}
			location = {
				NOT = {religion = atheism_reformed}
			}
		}
		allow = {
			location = {
				NOT = {religion = atheism_reformed}
			}
		}
		effect = {
			FROM = {
				set_secret_religion = atheism_revised	
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
	        	modifier = { 
				factor = 0.02
			}
		}
	}

	#Revised Atheist Embrace Local Religion
	revised_atheist_embrace_local_religion = {
		ai_check_interval = 24 #check only once every 24 months.
		filter = owned
		ai_target_filter = owned
		
		from_potential = {
			is_playable = yes
			has_dlc = "Holy Fury"
			higher_tier_than = BARON
			religion = atheism_revised
		}
		
		potential = {
			holder_scope = {
				character = FROM
			}
			location = {
				NOT = {
					OR = {
						religion = atheism
						religion = atheism_reformed
						religion = atheism_revised
					}
				}
			}
		}
		allow = {
			location = {
				NOT = {
					OR = {
						religion = atheism
						religion = atheism_reformed
						religion = atheism_revised
					}
				}
			}
			FROM = {
				OR = {
					has_secret_religion = no
					NOT = {secret_religion = ROOT}
				}
			}
		}
		effect = {
			FROM = {
				set_character_flag = abandon_atheism	
			}
			FROM = {
				set_secret_religion = ROOT
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
	        	modifier = { 
				factor = 0.05
			}
			modifier = { 
				factor = 0
				FROM = {has_secret_religion = yes}
			}
		}
	}
}